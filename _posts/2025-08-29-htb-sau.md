# Sau - Hack The Box

## Enumeration
### Nmap
Initial Nmap scan revealed SSH and port 55555 open.

<img width="1776" height="703" alt="000 - nmap" src="https://github.com/user-attachments/assets/07d9aee0-7059-4ae7-9485-d28e975dfa5a" />

### Web Enumeration
The target website is request-baskets v1.2.1 which is vulnerable to CVE-2023-27163 (SSRF).

<img width="964" height="724" alt="001 - target" src="https://github.com/user-attachments/assets/aea60cd0-26a0-4605-a2e8-3f0ff9e395cd" />

Searching through the Website revealed a [public exploit](https://github.com/madhavmehndiratta/CVE-2023-27163) on github. 

<img width="1639" height="699" alt="002 - SSRF" src="https://github.com/user-attachments/assets/ed5ebf33-c4a0-4e95-bf9c-f608c96b4108" />

Exploiting the target website revealed a internal website which is Maltrail v0.53

<img width="1800" height="709" alt="003 - internal website" src="https://github.com/user-attachments/assets/27170eaa-ef69-4b62-8919-894a328f5518" />

## Exploitation
### RCE
The internal website is Maltrail v0.53 which is vulnerable to Remote Code Execution. Some research revealed [this](https://securitylit.medium.com/exploiting-maltrail-v0-53-unauthenticated-remote-code-execution-rce-66d0666c18c5) post which includes a PoC.

<img width="1702" height="954" alt="004 - PoC" src="https://github.com/user-attachments/assets/9e0b22b1-eeae-450d-8195-6413000f552a" />

Running the exploit got me reverse shell.

<img width="730" height="100" alt="005 - run" src="https://github.com/user-attachments/assets/cec68e13-c0df-4b2f-8450-e6674d8f0ccc" />

<img width="961" height="557" alt="006 - user" src="https://github.com/user-attachments/assets/cf3f3d3d-7443-4ae8-9262-d77ee2da304d" />

## Privilege Escalation
### sudo -l
Initially I did some enumeration to escalate my privileges. The "sudo -l" command revealed I can run systemctl status for trail.service .

<img width="977" height="164" alt="007 - sudo l" src="https://github.com/user-attachments/assets/6e4d23f6-47a1-4cba-a79b-1b96bb0810da" />

Luckily there was a [GTFOBins page](https://gtfobins.github.io/gtfobins/systemctl/) for systemctl. There were 3 ways to exploit systemctl for privilege escalation. Mine was the third one. The status command opens a less page, so I can simply type !sh to get a root shell.

<img width="1744" height="916" alt="008 - root" src="https://github.com/user-attachments/assets/2ba1cb2d-1c14-4a98-8a04-89a74a10f517" />

## Pwned
The machine was fully compromised.

<img width="757" height="675" alt="009 - pwned" src="https://github.com/user-attachments/assets/b8c29c94-47da-47d3-b591-6232ebbb4082" />
